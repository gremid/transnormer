schema: '2.0'
stages:
  train:
    cmd: python src/transnormer/models/train_model.py
    deps:
    - path: data/interim/
      md5: b06fb78131a5c2e0086a04d7845eb8e5.dir
      size: 4631334659
      nfiles: 38
    - path: src/transnormer/data/loader.py
      md5: 93c6f48ee6589bae795e7c1a8385bc06
      size: 16822
    - path: src/transnormer/models/train_model.py
      md5: db9b541696c897143b5091c78e85f8f5
      size: 9113
    - path: src/transnormer/preprocess/translit.py
      md5: 66fb8313cdf24aa842fd6a39ea84ab79
      size: 1815
    params:
      training_config.toml:
        beam_search_decoding:
          no_repeat_ngram_size: 3
          early_stopping: true
          length_penalty: 2.0
          num_beams: 4
        data:
          paths_train:
          - data/interim/dtak-v03-1600-1699/dtak-v03-1600-1699-train.jsonl
          - data/interim/dtak-v03-1700-1799/dtak-v03-1700-1799-train.jsonl
          - data/interim/dtak-v03-1800-1899/dtak-v03-1800-1899-train.jsonl
          paths_validation:
          - data/interim/dtak-v03-1600-1699/dtak-v03-1600-1699-validation.jsonl
          - data/interim/dtak-v03-1700-1799/dtak-v03-1700-1799-validation.jsonl
          - data/interim/dtak-v03-1800-1899/dtak-v03-1800-1899-validation.jsonl
          paths_test:
          - data/interim/dtak-v03-1600-1699/dtak-v03-1600-1699-test.jsonl
          - data/interim/dtak-v03-1700-1799/dtak-v03-1700-1799-test.jsonl
          - data/interim/dtak-v03-1800-1899/dtak-v03-1800-1899-test.jsonl
          n_examples_train:
          - 100
          - 100
          - 100
          n_examples_validation:
          - 100
          - 100
          - 100
          n_examples_test:
          - 100
          - 100
          - 100
        language_models:
          checkpoint_encoder: dbmdz/bert-base-historic-multilingual-cased
          checkpoint_decoder: bert-base-multilingual-cased
        tokenizer:
          max_length_input: 128
          max_length_output: 128
          input_transliterator: Transliterator1
        training_hyperparams:
          batch_size: 32
          epochs: 10
          eval_steps: 25000
          eval_strategy: steps
          save_steps: 50
          fp16: true
    outs:
    - path: models/model/
      md5: 920fd9d8566c4044252a246d076627ad.dir
      size: 8866618687
      nfiles: 22
